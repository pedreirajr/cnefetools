[{"path":"https://pedreirajr.github.io/cnefetools/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 Jorge Ubirajara Pedreira Junior Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://pedreirajr.github.io/cnefetools/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jorge Ubirajara Pedreira Junior. Author, maintainer. Kaio Cunha Pedreira. Contributor.","code":""},{"path":"https://pedreirajr.github.io/cnefetools/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Pedreira Junior J (2025). cnefetools: Tools Working Brazilian CNEFE 2022 Address Data. R package version 0.1.1, https://github.com/pedreirajr/cnefetools.","code":"@Manual{,   title = {cnefetools: Tools for Working with Brazilian CNEFE 2022 Address Data},   author = {Jorge Ubirajara {Pedreira Junior}},   year = {2025},   note = {R package version 0.1.1},   url = {https://github.com/pedreirajr/cnefetools}, }"},{"path":"https://pedreirajr.github.io/cnefetools/index.html","id":"cnefetools-tools-for-working-with-brazilian-cnefe-address-data-","dir":"","previous_headings":"","what":"Tools for Working with Brazilian CNEFE 2022 Address Data","title":"Tools for Working with Brazilian CNEFE 2022 Address Data","text":"{cnefetools} provides helper functions work 2022 Brazilian National Address File Statistical Purposes (Cadastro Nacional de Endereços para Fins Estatísticos, CNEFE), address-level dataset released Brazilian Institute Geography Statistics (Instituto Brasileiro de Geografia e Estatística, IBGE).","code":""},{"path":"https://pedreirajr.github.io/cnefetools/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Tools for Working with Brazilian CNEFE 2022 Address Data","text":"","code":"# install.packages(\"pak\") pak::pak(\"pedreirajr/cnefetools\")"},{"path":"https://pedreirajr.github.io/cnefetools/index.html","id":"basic-usage","dir":"","previous_headings":"","what":"Basic usage","title":"Tools for Working with Brazilian CNEFE 2022 Address Data","text":"","code":"library(cnefetools) library(dplyr)  # Example: read CNEFE data for a municipality (Salvador) as an Arrow table tab_ssa <- read_cnefe(2927408, cache = TRUE)  # Convert to a data frame for inspection df_ssa <- tab_ssa |>    as.data.frame() |>    dplyr::tibble()  head(df_ssa) #> # A tibble: 6 × 34 #>   COD_UNICO_ENDERECO COD_UF COD_MUNICIPIO COD_DISTRITO COD_SUBDISTRITO COD_SETOR #>                <int>  <int>         <int>        <int>         <int64> <chr>     #> 1          222386741     29       2927408    292740805     29274080518 29274080… #> 2           27995350     29       2927408    292740805     29274080522 29274080… #> 3           28034841     29       2927408    292740805     29274080522 29274080… #> 4          217544957     29       2927408    292740805     29274080518 29274080… #> 5          217639781     29       2927408    292740805     29274080526 29274080… #> 6          217639701     29       2927408    292740805     29274080526 29274080… #> # ℹ 28 more variables: NUM_QUADRA <int>, NUM_FACE <int>, CEP <int>, #> #   DSC_LOCALIDADE <chr>, NOM_TIPO_SEGLOGR <chr>, NOM_TITULO_SEGLOGR <chr>, #> #   NOM_SEGLOGR <chr>, NUM_ENDERECO <int>, DSC_MODIFICADOR <chr>, #> #   NOM_COMP_ELEM1 <chr>, VAL_COMP_ELEM1 <chr>, NOM_COMP_ELEM2 <chr>, #> #   VAL_COMP_ELEM2 <chr>, NOM_COMP_ELEM3 <chr>, VAL_COMP_ELEM3 <chr>, #> #   NOM_COMP_ELEM4 <chr>, VAL_COMP_ELEM4 <chr>, NOM_COMP_ELEM5 <chr>, #> #   VAL_COMP_ELEM5 <chr>, LATITUDE <dbl>, LONGITUDE <dbl>, …"},{"path":"https://pedreirajr.github.io/cnefetools/index.html","id":"spatial-output-and-quick-map","dir":"","previous_headings":"","what":"Spatial output and quick map","title":"Tools for Working with Brazilian CNEFE 2022 Address Data","text":"prefer work spatial objects, read_cnefe() can return sf object setting output = \"sf\". example reads CNEFE data Salvador, filters religious facilities (COD_ESPECIE == 8), plots ggplot2:  Warning large municipalities, CNEFE may contain 1 million address points. Plotting coordinates can slow memory intensive, consider filtering area interest sampling points creating maps.","code":"library(cnefetools) library(sf) library(ggplot2) library(dplyr)  # Read CNEFE data as sf (Salvador, IBGE code = 2927408) tab_ssa_sf <- read_cnefe(code_muni = 2927408, output = \"sf\", cache = TRUE)  # Keep only religious facilities (COD_ESPECIE == 8) temples_ssa <- tab_ssa_sf |>    dplyr::filter(COD_ESPECIE == 8)  ggplot() +   geom_sf(data = temples_ssa, size = 0.3, alpha = 0.6) +   coord_sf() +   theme_minimal()"},{"path":"https://pedreirajr.github.io/cnefetools/index.html","id":"caching-behavior","dir":"","previous_headings":"","what":"Caching behavior","title":"Tools for Working with Brazilian CNEFE 2022 Address Data","text":"default, cache = TRUE stores downloaded ZIP file user-level cache directory specific package. prefer avoid persistent caching, set: case, ZIP file stored temporary location removed reading.","code":"tab_ssa <- read_cnefe(code_muni = 2927408, cache = FALSE)"},{"path":"https://pedreirajr.github.io/cnefetools/index.html","id":"accessing-official-cnefe-documentation","dir":"","previous_headings":"","what":"Accessing official CNEFE documentation","title":"Tools for Working with Brazilian CNEFE 2022 Address Data","text":"{cnefetools} includes local copies official methodological note variable dictionary 2022 CNEFE released IBGE. can open documents default PDF spreadsheet viewers :","code":"# Open the official methodological note (PDF) cnefe_doc()  # Open the official variable dictionary (Excel) cnefe_dictionary()"},{"path":"https://pedreirajr.github.io/cnefetools/index.html","id":"hexagon-level-address-counts-with-hex_cnefe_counts","dir":"","previous_headings":"","what":"Hexagon-level address counts with hex_cnefe_counts()","title":"Tools for Working with Brazilian CNEFE 2022 Address Data","text":"hex_cnefe_counts() function aggregates CNEFE address points H3 hexagonal grid resolution returns sf object one row per hexagon. includes: id_hex: H3 cell identifier. addr_type1 … addr_type8: counts address category (see ?hex_cnefe_counts mapping). geometry: hexagon geometry (CRS 4326).","code":""},{"path":"https://pedreirajr.github.io/cnefetools/index.html","id":"choosing-a-backend-performance","dir":"","previous_headings":"Hexagon-level address counts with hex_cnefe_counts()","what":"Choosing a backend (performance)","title":"Tools for Working with Brazilian CNEFE 2022 Address Data","text":"hex_cnefe_counts() supports two backends via backend argument: backend = \"duckdb\" (default): uses DuckDB community h3 extension compute H3 cell id aggregate counts SQL. substantially faster large municipalities avoids materializing points sf object R. backend = \"r\": uses sf + h3jsr R. useful prefer pure-R workflow, can much slower large cities. use backend = \"duckdb\", need duckdb installed. first use, DuckDB may download install h3 zipfs extensions (DuckDB community extensions). Subsequent runs reuse installed extensions. example São Paulo (IBGE code 3550308) H3 resolution 9: can visualize spatial distribution private households (addr_type1) ggplot2:","code":"library(cnefetools) library(sf) library(ggplot2) library(dplyr)  # Fast path (default): DuckDB backend hex_sp <- hex_cnefe_counts(code_muni = 3550308, h3_resolution = 9, backend = \"duckdb\", verbose = TRUE)  # Pure-R path (can be slower for large cities) # hex_sp_r <- hex_cnefe_counts(code_muni = 3550308, h3_resolution = 9, backend = \"r\", verbose = TRUE) ggplot(hex_sp) +   geom_sf(aes(fill = addr_type1), color = NA) +   scale_fill_viridis_c(option = \"magma\", trans = \"sqrt\") +   coord_sf() +   labs(     fill = \"Count\",     title = \"Private households (addr_type1)\",     subtitle = \"São Paulo (IBGE 3550308), H3 resolution 9\"   ) +   theme_minimal()"},{"path":"https://pedreirajr.github.io/cnefetools/index.html","id":"land-use-mix-indicators-with-compute_lumi","dir":"","previous_headings":"","what":"Land-use mix indicators with compute_lumi()","title":"Tools for Working with Brazilian CNEFE 2022 Address Data","text":"compute_lumi() function computes land-use mix indicators H3 hexagonal grid user-defined resolution Brazilian municipality covered 2022 CNEFE dataset (Pedreira Junior et al., 2025). Internally, : () reads preprocesses address points CNEFE; (ii) assigns point H3 cell; (iii) aggregates residential non-residential addresses per hexagon; (iv) computes following indicators: p_res: proportion residential addresses hexagon. ei: Entropy Index (EI), ranging 0 (single use) 1 (maximum mix), maximum attained p_res = 0.5. hhi: Herfindahl–Hirschman Index (HHI), ranging 0.5 (maximum mix p_res = 0.5) 1 (single use). bal: Balance Index (BAL), ranging 0 (single use) 1 (maximum balance), balance defined relative citywide residential proportion (.e., maximum occurs p_res equals citywide residential share). hhi_adp: adapted HHI, adds directionality takes values [-1, 1], negative values indicate non-residential dominance positive values indicate residential dominance (0 indicates 50/50 split). bgbi: Bidirectional Global-centered Balance Index (BGBI), measures deviation local residential share (p_res) citywide residential proportion, also [-1, 1].","code":""},{"path":"https://pedreirajr.github.io/cnefetools/index.html","id":"choosing-a-backend-performance-1","dir":"","previous_headings":"Land-use mix indicators with compute_lumi()","what":"Choosing a backend (performance)","title":"Tools for Working with Brazilian CNEFE 2022 Address Data","text":"Like hex_cnefe_counts(), compute_lumi() supports backend argument. example Fortaleza (IBGE code 2304400) H3 resolution 8: can visualize spatial distribution BGBI indicator ggplot2:","code":"library(cnefetools) library(sf) library(ggplot2) library(dplyr)  # Compute land use mix indicators (recommended for large cities) lumi_for <- compute_lumi(code_muni = 2304400, h3_resolution = 8, backend = \"duckdb\", verbose = TRUE) ggplot(lumi_for) +   geom_sf(aes(fill = bgbi), color = NA) +   scale_fill_viridis_c(option = \"plasma\") +   coord_sf() +   labs(     fill = \"BGBI\",     title = \"Bidirectional Global-centered Balance Index (BGBI)\",     subtitle = \"Fortaleza (IBGE 2304400), H3 resolution 8\"   ) +   theme_minimal()"},{"path":"https://pedreirajr.github.io/cnefetools/index.html","id":"dasymetric-interpolation-from-census-tracts-to-h3-with-tracts_to_h3","dir":"","previous_headings":"","what":"Dasymetric interpolation from census tracts to H3 with tracts_to_h3()","title":"Tools for Working with Brazilian CNEFE 2022 Address Data","text":"tracts_to_h3() implements dasymetric interpolation workflow transfers census tract totals address-level points (CNEFE), aggregates allocated values H3 grid.","code":""},{"path":"https://pedreirajr.github.io/cnefetools/index.html","id":"what-the-function-does","dir":"","previous_headings":"Dasymetric interpolation from census tracts to H3 with tracts_to_h3()","what":"What the function does","title":"Tools for Working with Brazilian CNEFE 2022 Address Data","text":"Downloads () caches UF-specific Parquet file 2022 census tract geometries tract-level aggregates. Reads CNEFE points requested municipality (cached municipal ZIP). Builds tract geometries (MULTIPOLYGON) point geometries coordinates. Spatially assigns CNEFE point census tract. tract dwelling type, computes many eligible dwellings exist tract allocates tract totals across points. Assigns point H3 cell chosen resolution sums allocated values per cell. Builds H3 hexagon sf layer joins aggregated values. output sf object (CRS 4326) one row per H3 hexagon, id_hex, interpolated variables requested.","code":""},{"path":"https://pedreirajr.github.io/cnefetools/index.html","id":"variables-available-for-interpolation","dir":"","previous_headings":"Dasymetric interpolation from census tracts to H3 with tracts_to_h3()","what":"Variables available for interpolation","title":"Tools for Working with Brazilian CNEFE 2022 Address Data","text":"moment, tracts_to_h3() can interpolate variables (sourced tract-level aggregates), choosing ones compute via vars argument: n_inhab_p: total population private households (domicílios particulares); n_inhab_c: total population collective households (domicílios coletivos); n_resp: number household heads (Pessoas responsáveis); Sex totals: male (total male population) female (total female population); Age groups : age_0_4, age_5_9, age_10_14, age_15_19 - age_20_24, age_25_29, age_30_39, age_40_49, age_50_59, age_60_69 age_70m (70+); Income: avg_inc_resp: average income responsible person (mean tract level).","code":""},{"path":"https://pedreirajr.github.io/cnefetools/index.html","id":"allocation-rules-important","dir":"","previous_headings":"Dasymetric interpolation from census tracts to H3 with tracts_to_h3() > Variables available for interpolation","what":"Allocation rules (important)","title":"Tools for Working with Brazilian CNEFE 2022 Address Data","text":"values allocated across private household points within tract private dwellings exist; tract private dwellings, value allocated across collective household points (); tract eligible dwellings (tract total NA), tract total allocated, reported diagnostics. tract value assigned directly eligible dwelling point (private, collective private dwellings tract); avg_inc_resp NA, function reports many tracts missing values.","code":""},{"path":"https://pedreirajr.github.io/cnefetools/index.html","id":"diagnostics-and-timing","dir":"","previous_headings":"Dasymetric interpolation from census tracts to H3 with tracts_to_h3()","what":"Diagnostics and timing","title":"Tools for Working with Brazilian CNEFE 2022 Address Data","text":"tracts_to_h3() prints execution timing summary (verbose = TRUE) may emit warning diagnostic report. diagnostics report includes, requested variable: unallocated tract totals (percentage relative tract total municipality); tracts NA totals; tracts eligible dwellings (nothing allocated); unmatched CNEFE points (points fall tract).","code":""},{"path":"https://pedreirajr.github.io/cnefetools/index.html","id":"example-recife-2611606","dir":"","previous_headings":"Dasymetric interpolation from census tracts to H3 with tracts_to_h3()","what":"Example: Recife (2611606)","title":"Tools for Working with Brazilian CNEFE 2022 Address Data","text":"","code":"library(cnefetools) library(dplyr) library(ggplot2)  # Interpolate to H3 for Recife at resolution 9 # Example vars: private-household population and mean income of the responsible person rec_hex <- tracts_to_h3(   code_muni = 2611606,   h3_resolution = 9,   vars = c(\"n_inhab_p\", \"avg_inc_resp\"),   cache = TRUE,   verbose = TRUE ) # Map private-household population ggplot(rec_hex) +   geom_sf(aes(fill = n_inhab_p), color = NA) +   scale_fill_viridis_c(trans = \"sqrt\") +   coord_sf() +   labs(     title = \"Dasymetric interpolation to H3 using CNEFE (Recife)\",     subtitle = \"Private-household population (n_inhab_p), H3 resolution 9\",     fill = \"Population\"   ) +   theme_minimal() # Map avg income of the household head ggplot(rec_hex) +   geom_sf(aes(fill = avg_inc_resp), color = NA) +   scale_fill_viridis_c() +   coord_sf() +   labs(     title = \"Dasymetric interpolation to H3 using CNEFE (Recife)\",     subtitle = \"Average income of the responsible person (avg_inc_resp), H3 resolution 9\",     fill = \"Income\"   ) +   theme_minimal()"},{"path":"https://pedreirajr.github.io/cnefetools/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Tools for Working with Brazilian CNEFE 2022 Address Data","text":"use {cnefetools} work, please cite associated preprint: Pedreira Jr., J. U.; Louro, T. V.; Assis, L. B. M.; Brito, P. L. Measuring land use mix address-level census data (2025). engrXiv. https://engrxiv.org/preprint/view/5975","code":""},{"path":"https://pedreirajr.github.io/cnefetools/index.html","id":"roadmap","dir":"","previous_headings":"","what":"Roadmap","title":"Tools for Working with Brazilian CNEFE 2022 Address Data","text":"current version focuses efficient download, caching, reading municipality-level CNEFE files, plus scalable H3-based analytics (counts, land-use mix, tract--hex dasymetric interpolation). Planned next steps include: Expanding set tract-level variables available dasymetric interpolation. diagnostics summary helpers (example, returning diagnostics object attribute). Support alternative aggregate data sources target geographic output (H3), available.","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/build_h3_grid.html","id":null,"dir":"Reference","previous_headings":"","what":"Build an H3 grid as an sf object — build_h3_grid","title":"Build an H3 grid as an sf object — build_h3_grid","text":"Internal helper build H3 grid either: vector H3 cell ids (id_hex), municipality boundary (code_muni) using geobr (year fixed 2024).","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/build_h3_grid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build an H3 grid as an sf object — build_h3_grid","text":"","code":"build_h3_grid(h3_resolution, id_hex = NULL, code_muni = NULL, boundary = NULL)"},{"path":"https://pedreirajr.github.io/cnefetools/reference/build_h3_grid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build an H3 grid as an sf object — build_h3_grid","text":"h3_resolution Integer. H3 resolution. id_hex Character/integer vector H3 cell ids (optional). code_muni Integer. Seven-digit IBGE municipality code (optional). boundary sf polygon area interest (optional).","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/build_h3_grid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build an H3 grid as an sf object — build_h3_grid","text":"sf object (CRS 4326) columns id_hex geometry.","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/cnefe_dictionary.html","id":null,"dir":"Reference","previous_headings":"","what":"Open the official CNEFE 2022 data dictionary — cnefe_dictionary","title":"Open the official CNEFE 2022 data dictionary — cnefe_dictionary","text":"Opens bundled Excel data dictionary system's default spreadsheet viewer (e.g., Excel, LibreOffice).","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/cnefe_dictionary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Open the official CNEFE 2022 data dictionary — cnefe_dictionary","text":"","code":"cnefe_dictionary()"},{"path":"https://pedreirajr.github.io/cnefetools/reference/cnefe_dictionary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Open the official CNEFE 2022 data dictionary — cnefe_dictionary","text":"Invisibly, path Excel file inside installed package.","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/cnefe_doc.html","id":null,"dir":"Reference","previous_headings":"","what":"Open the official CNEFE methodological note — cnefe_doc","title":"Open the official CNEFE methodological note — cnefe_doc","text":"Opens bundled PDF methodological document system's default PDF viewer.","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/cnefe_doc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Open the official CNEFE methodological note — cnefe_doc","text":"","code":"cnefe_doc()"},{"path":"https://pedreirajr.github.io/cnefetools/reference/cnefe_doc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Open the official CNEFE methodological note — cnefe_doc","text":"Invisibly, path PDF file inside installed package.","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/cnefetools-package.html","id":null,"dir":"Reference","previous_headings":"","what":"cnefetools: Tools for Working with Brazilian CNEFE 2022 Address Data — cnefetools-package","title":"cnefetools: Tools for Working with Brazilian CNEFE 2022 Address Data — cnefetools-package","text":"Provides helper functions work Cadastro Nacional de Endereços para Fins Estatísticos (CNEFE) 2022 Brazilian census. initial version focuses efficiently downloading, caching, reading municipality-level CNEFE CSV files Arrow tables downstream analysis.","code":""},{"path":[]},{"path":"https://pedreirajr.github.io/cnefetools/reference/cnefetools-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"cnefetools: Tools for Working with Brazilian CNEFE 2022 Address Data — cnefetools-package","text":"Maintainer: Jorge Ubirajara Pedreira Junior jorge.ubirajara@ufba.br (ORCID) contributors: Kaio Cunha Pedreira kaiocp7@gmail.com [contributor]","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/compute_lumi.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute land-use mix indicators on an H3 grid — compute_lumi","title":"Compute land-use mix indicators on an H3 grid — compute_lumi","text":"compute_lumi() reads CNEFE 2022 records given municipality, assigns address point H3 cell, computes land-use mix indices per hexagon (EI, HHI, adapted HHI, BGBI), following methodology proposed Pedreira Jr. et al. (2025).","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/compute_lumi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute land-use mix indicators on an H3 grid — compute_lumi","text":"","code":"compute_lumi(   code_muni,   h3_resolution = 9,   verbose = TRUE,   backend = c(\"duckdb\", \"r\") )"},{"path":"https://pedreirajr.github.io/cnefetools/reference/compute_lumi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute land-use mix indicators on an H3 grid — compute_lumi","text":"code_muni Integer. Seven-digit IBGE municipality code. h3_resolution Integer. H3 grid resolution (default: 9). verbose Logical; TRUE, prints messages timing information. backend Character. \"duckdb\" (default) uses DuckDB + H3 extension reading directly cached ZIP. \"r\" computes H3 R using h3jsr.","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/compute_lumi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute land-use mix indicators on an H3 grid — compute_lumi","text":"sf::sf object CRS 4326 containing: id_hex: H3 cell identifier p_res: share residential addresses hexagon ei,bal, hhi, hhi_adp, bgbi: land-use mix indicators geometry: hexagon geometry","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/compute_lumi.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Compute land-use mix indicators on an H3 grid — compute_lumi","text":"Pedreira Jr., J. U.; Louro, T. V.; Assis, L. B. M.; Brito, P. L. Measuring land use mix address-level census data (2025). engrXiv. https://engrxiv.org/preprint/view/5975","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/hex_cnefe_counts.html","id":null,"dir":"Reference","previous_headings":"","what":"Count CNEFE address species on an H3 grid — hex_cnefe_counts","title":"Count CNEFE address species on an H3 grid — hex_cnefe_counts","text":"hex_cnefe_counts() reads CNEFE records given municipality, assigns address point H3 cell, builds full H3 grid municipal boundary (year fixed 2024), returns per-hexagon counts COD_ESPECIE addr_type1 addr_type8.","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/hex_cnefe_counts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Count CNEFE address species on an H3 grid — hex_cnefe_counts","text":"","code":"hex_cnefe_counts(   code_muni,   h3_resolution = 9,   verbose = TRUE,   backend = c(\"duckdb\", \"r\") )"},{"path":"https://pedreirajr.github.io/cnefetools/reference/hex_cnefe_counts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Count CNEFE address species on an H3 grid — hex_cnefe_counts","text":"code_muni Integer. Seven-digit IBGE municipality code. h3_resolution Integer. H3 grid resolution (default: 9). verbose Logical; TRUE, prints messages timing information. backend Character. \"duckdb\" (default) uses DuckDB H3 extension aggregate directly cached ZIP. \"r\" uses h3jsr R.","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/hex_cnefe_counts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Count CNEFE address species on an H3 grid — hex_cnefe_counts","text":"sf::sf object CRS 4326 containing: id_hex: H3 cell identifier addr_type1 ... addr_type8: counts per type geometry: hexagon geometry","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/hex_cnefe_counts.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Count CNEFE address species on an H3 grid — hex_cnefe_counts","text":"counts columns addr_type1 addr_type8 correspond : addr_type1: Private household (Domicílio particular) addr_type2: Collective household (Domicílio coletivo) addr_type3: Agricultural establishment (Estabelecimento agropecuário) addr_type4: Educational establishment (Estabelecimento de ensino) addr_type5: Health establishment (Estabelecimento de saúde) addr_type6: Establishment purposes (Estabelecimento de outras finalidades) addr_type7: Building construction renovation (Edificação em construção ou reforma) addr_type8: Religious establishment (Estabelecimento religioso)","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/read_cnefe.html","id":null,"dir":"Reference","previous_headings":"","what":"Read CNEFE 2022 data for a given municipality — read_cnefe","title":"Read CNEFE 2022 data for a given municipality — read_cnefe","text":"Downloads reads CNEFE 2022 CSV file given IBGE municipality code, using official IBGE FTP structure. function relies internal index linking municipality codes corresponding ZIP URLs. Data returned either Arrow Table (default) sf object SIRGAS 2000 coordinates.","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/read_cnefe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read CNEFE 2022 data for a given municipality — read_cnefe","text":"","code":"read_cnefe(code_muni, verbose = TRUE, cache = TRUE, output = c(\"arrow\", \"sf\"))"},{"path":"https://pedreirajr.github.io/cnefetools/reference/read_cnefe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read CNEFE 2022 data for a given municipality — read_cnefe","text":"code_muni Integer. Seven-digit IBGE municipality code. verbose Logical; TRUE, print informative messages download, extraction, reading steps. cache Logical; TRUE, cache downloaded ZIP file user-level cache directory specific package. FALSE, temporary file used removed reading. output Character. Output format. \"arrow\" (default) returns arrow::Table, whereas \"sf\" returns sf point object coordinates built LONGITUDE / LATITUDE CRS 4674.","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/read_cnefe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read CNEFE 2022 data for a given municipality — read_cnefe","text":"output = \"arrow\", arrow::Table containing CNEFE records given municipality. output = \"sf\", sf object point geometry EPSG:4674 (SIRGAS 2000), using LONGITUDE LATITUDE columns.","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/read_cnefe.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Read CNEFE 2022 data for a given municipality — read_cnefe","text":"output = \"arrow\" (default), function perform spatial conversion simply returns Arrow table. output = \"sf\", function converts result sf point object using LONGITUDE LATITUDE columns, CRS EPSG:4674 (SIRGAS 2000), keeping columns final object (remove = FALSE).","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/read_cnefe.html","id":"caching","dir":"Reference","previous_headings":"","what":"Caching","title":"Read CNEFE 2022 data for a given municipality — read_cnefe","text":"cache = TRUE (default), downloaded ZIP file stored user-level cache directory specific package, created via tools::R_user_dir() = \"cache\". avoids re-downloading municipality file across sessions. cache = FALSE, ZIP file stored temporary location removed function exits.","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/tracts_to_h3.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert census tract aggregates to an H3 grid using CNEFE points — tracts_to_h3","title":"Convert census tract aggregates to an H3 grid using CNEFE points — tracts_to_h3","text":"tracts_to_h3() performs dasymetric interpolation following steps: census tract totals allocated CNEFE dwelling points inside tract; allocated values aggregated H3 grid user-defined resolution. function uses DuckDB spatial H3 extensions heavy work.","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/tracts_to_h3.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert census tract aggregates to an H3 grid using CNEFE points — tracts_to_h3","text":"","code":"tracts_to_h3(   code_muni,   h3_resolution = 9L,   vars = c(\"n_inhab_p\", \"n_inhab_c\"),   cache = TRUE,   verbose = TRUE )"},{"path":"https://pedreirajr.github.io/cnefetools/reference/tracts_to_h3.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert census tract aggregates to an H3 grid using CNEFE points — tracts_to_h3","text":"code_muni Integer. Seven-digit IBGE municipality code. h3_resolution Integer. H3 resolution (0 15). Defaults 9. vars Character vector. Names tract-level variables interpolate. Supported variables: n_inhab_p: population private households (Domicílios particulares). n_inhab_c: population collective households (Domicílios coletivos). male: total male population. female: total female population. age_0_4, age_5_9, age_10_14, age_15_19, age_20_24, age_25_29, age_30_39, age_40_49, age_50_59, age_60_69, age_70m: population age group. n_resp: number household heads (Pessoas responsáveis por domicílios). avg_inc_resp: average income household heads. Allocation rules: n_inhab_p allocated private dwellings. n_inhab_c allocated collective dwellings. sum-like variables allocated private dwellings tract ; tract zero private dwellings collective dwellings, allocated collective. avg_inc_resp assigned (split) eligible dwelling point using eligibility rule. cache Logical. Whether use existing package cache assets CNEFE zips. verbose Logical. Whether print step messages timing.","code":""},{"path":"https://pedreirajr.github.io/cnefetools/reference/tracts_to_h3.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert census tract aggregates to an H3 grid using CNEFE points — tracts_to_h3","text":"sf object (CRS 4326) H3 grid requested interpolated variables. Attributes: attr(x, \"timing\"): named numeric vector step timings (seconds).","code":""},{"path":"https://pedreirajr.github.io/cnefetools/news/index.html","id":"cnefetools-011","dir":"Changelog","previous_headings":"","what":"cnefetools 0.1.1","title":"cnefetools 0.1.1","text":"Adds Balance Index (BAL), bal compute_lumi() function.","code":""},{"path":"https://pedreirajr.github.io/cnefetools/news/index.html","id":"cnefetools-010","dir":"Changelog","previous_headings":"","what":"cnefetools 0.1.0","title":"cnefetools 0.1.0","text":"New: tracts_to_h3() dasymetric interpolation tract aggregates CNEFE dwelling points H3 hexagons using DuckDB (spatial + h3). Added UF-level census tract Parquet assets (WKB geometry) hosted GitHub Releases downloaded -demand caching.","code":""},{"path":"https://pedreirajr.github.io/cnefetools/news/index.html","id":"cnefetools-006","dir":"Changelog","previous_headings":"","what":"cnefetools 0.0.6","title":"cnefetools 0.0.6","text":"Moves DBI duckdb Imports DuckDB backend works box Removes silent fallback backend = \"r\" backend = \"duckdb\" requested changes outputs; behavior unchanged aside dependency handling","code":""},{"path":"https://pedreirajr.github.io/cnefetools/news/index.html","id":"cnefetools-005","dir":"Changelog","previous_headings":"","what":"cnefetools 0.0.5","title":"cnefetools 0.0.5","text":"Makes unit tests reproducible CI-friendly removing dependencies network access local cache state (offline ZIP fixture mocked downloads) Improves robustness read_cnefe(output = \"sf\") handling missing coordinates converting sf Updates COD_ESPECIE documentation removes tidyselect deprecation warnings tests internals","code":""},{"path":"https://pedreirajr.github.io/cnefetools/news/index.html","id":"cnefetools-004","dir":"Changelog","previous_headings":"","what":"cnefetools 0.0.4","title":"cnefetools 0.0.4","text":"Major speed-H3 assignment hex-level aggregation via DuckDB + H3 extension (SQL), runtimes dropping minutes seconds large municipalities Adds configurable backend backwards compatibility: backend = \"duckdb\" (default) backend = \"r\" hex_cnefe_counts() compute_lumi() Refactors internals reuse cached ZIPs consolidate common helpers, reducing repeated overhead improving maintainability","code":""},{"path":"https://pedreirajr.github.io/cnefetools/news/index.html","id":"cnefetools-003","dir":"Changelog","previous_headings":"","what":"cnefetools 0.0.3","title":"cnefetools 0.0.3","text":"robust downloads retry logic increased timeout needed Avoids leaving partial corrupted ZIP files cache Automatically detects corrupted cached ZIPs re-downloads extraction","code":""},{"path":"https://pedreirajr.github.io/cnefetools/news/index.html","id":"cnefetools-002","dir":"Changelog","previous_headings":"","what":"cnefetools 0.0.2","title":"cnefetools 0.0.2","text":"Add compute_lumi() compute land-use mix indicators (EI, HHI, adapted HHI, BGBI) H3 grids. Extend README examples Fortaleza (code 2304400) BGBI maps.","code":""},{"path":[]},{"path":"https://pedreirajr.github.io/cnefetools/news/index.html","id":"cnefetools-0009000","dir":"Changelog","previous_headings":"","what":"cnefetools 0.0.0.9000","title":"cnefetools 0.0.0.9000","text":"Initial development version. Basic package infrastructure set .","code":""}]
