% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tracts_to_h3.R
\name{tracts_to_h3}
\alias{tracts_to_h3}
\title{Convert census tract aggregates to an H3 grid using CNEFE points}
\usage{
tracts_to_h3(
  code_muni,
  h3_resolution = 9L,
  vars = c("n_inhab_p", "n_inhab_c"),
  cache = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{code_muni}{Integer. Seven-digit IBGE municipality code.}

\item{h3_resolution}{Integer. H3 resolution (0 to 15). Defaults to 9.}

\item{vars}{Character vector. Names of tract-level variables to interpolate.
Supported variables:
\itemize{
\item \code{n_inhab_p}: population in private households (\emph{Domic\\u00edlios particulares}).
\item \code{n_inhab_c}: population in collective households (\emph{Domic\\u00edlios coletivos}).
\item \code{male}: total male population.
\item \code{female}: total female population.
\item \code{age_0_4}, \code{age_5_9}, \code{age_10_14}, \code{age_15_19}, \code{age_20_24}, \code{age_25_29},
\code{age_30_39}, \code{age_40_49}, \code{age_50_59}, \code{age_60_69}, \code{age_70m}: population by age group.
\item \code{n_resp}: number of household heads (\emph{Pessoas respons\\u00e1veis por domic\\u00edlios}).
\item \code{avg_inc_resp}: average income of the household heads.
}

Allocation rules:
\itemize{
\item \code{n_inhab_p} is allocated only to private dwellings.
\item \code{n_inhab_c} is allocated only to collective dwellings.
\item All other sum-like variables are allocated to private dwellings when the tract has any;
if the tract has zero private dwellings but has collective dwellings, they are allocated to collective.
\item \code{avg_inc_resp} is assigned (not split) to each eligible dwelling point using the same eligibility rule.
}}

\item{cache}{Logical. Whether to use the existing package cache for assets and CNEFE zips.}

\item{verbose}{Logical. Whether to print step messages and timing.}
}
\value{
An \code{sf} object (CRS 4326) with an H3 grid and the requested interpolated variables.
Attributes:
\itemize{
\item \code{attr(x, "timing")}: named numeric vector with step timings (seconds).
}
}
\description{
\code{tracts_to_h3()} performs a dasymetric interpolation with the following steps:
\enumerate{
\item census tract totals are allocated to CNEFE dwelling points inside each tract;
\item allocated values are aggregated to an H3 grid at a user-defined resolution.
}

The function uses DuckDB with the spatial and H3 extensions for the heavy work.
}
